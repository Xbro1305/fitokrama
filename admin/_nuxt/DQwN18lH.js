import{u as T}from"./B83tnpwP.js";import{d as x,D as S,C as B,r as p,M as D,F as _,A as o,q as N,L as h,t as v,z as n,B as y,G as r,I as P,K as $,y as A,H as O}from"./CD-ciyMC.js";import{V as U,a as z,b as F}from"./S1xGE2Sl.js";import{V as H}from"./D2o8XtCw.js";import"./D2qL_eWx.js";import"./tHn_lS1N.js";import"./BJOK9706.js";import"./BT2HD4FG.js";const Q=x({__name:"assembly_post",async setup(I){let a,u;T({title:"Сборка на почту"});const{email:i,password:m}=S(),{showError:d,showSuccess:V}=B(),c=N().public.backendUrl,f=p([]),s=p([]),{data:l,error:b}=([a,u]=D(()=>h(`${c}/orders_to_send.php`,{method:"POST",body:{staff_login:i,staff_password:m}},"$KCa4DdInez")),a=await a,u(),a);l&&l.value?f.value=l.value:b&&d("Ошибка соединения с сервером");const g=[{title:"Название",key:"name"},{title:"Заказов",key:"orders_count",value:t=>t.orders.length},{title:"Заказы",key:"orders",value:t=>t.orders.map(e=>e.number).join(", ")}],C=t=>new Promise(e=>setTimeout(e,t)),k=async()=>{const{data:t}=await h(`${c}/orders_list_to_send.php`,{method:"POST",body:{staff_login:i,staff_password:m,methods:s.value}},"$tiMBmtbOP6");if(t.value.message?V(t.value.message):t.value.error&&d(t.value.error),t.value.for_print){const e=window.open("","_blank");e==null||e.document.write(t.value.for_print),C(200).then(()=>{e==null||e.document.close(),e==null||e.focus(),e==null||e.print()})}};return(t,e)=>(v(),_(U,null,{default:o(()=>[n(z,null,{default:o(()=>e[1]||(e[1]=[y(" Сборка на почту ")])),_:1}),n(F,null,{default:o(()=>[n(H,{modelValue:r(s),"onUpdate:modelValue":e[0]||(e[0]=w=>P(s)?s.value=w:null),headers:g,items:r(f),"show-select":""},null,8,["modelValue","items"]),r(s).length>0?(v(),_($,{key:0,color:"primary",onClick:k},{default:o(()=>[y(" Распечатать список на отправку ("+A(r(s).length)+") ",1)]),_:1})):O("",!0)]),_:1})]),_:1}))}});export{Q as default};

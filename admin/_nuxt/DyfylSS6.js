import{u as w}from"./C8wjtVdh.js";import{d as T,C as x,r as c,J as S,E as f,A as a,q as B,I as p,t as _,z as l,B as h,F as r,H as N,y as P,G as $}from"./DD7AHv1g.js";import{u as A}from"./A5x_le5I.js";import{V as D,a as O,b as U}from"./MCwiuoYB.js";import{V as z}from"./ChHQ47om.js";import{V as E}from"./hYNdz_3a.js";import"./BQXSZ5PM.js";import"./DNOu9Y9V.js";import"./D-Pd036u.js";import"./DWGaNmQL.js";import"./DI6sJGf3.js";import"./9V3CzVYM.js";import"./Dgn9K1u6.js";import"./JcpH5EyD.js";const ee=T({__name:"assembly_post",async setup(F){let o,n;w({title:"Сборка на почту"});const{email:m,password:u}=x(),{showError:V,showSuccess:y}=A(),i=B().public.backendUrl,d=c([]),s=c([]),{data:v}=([o,n]=S(()=>p(`${i}/orders_to_send.php`,{method:"POST",body:{staff_login:m,staff_password:u}},"$KCa4DdInez")),o=await o,n(),o);d.value=v.value;const b=[{title:"Название",key:"name"},{title:"Заказов",key:"orders_count",value:t=>t.orders.length},{title:"Заказы",key:"orders",value:t=>t.orders.map(e=>e.number).join(", ")}],g=t=>new Promise(e=>setTimeout(e,t)),C=async()=>{const{data:t}=await p(`${i}/orders_list_to_send.php`,{method:"POST",body:{staff_login:m,staff_password:u,methods:s.value}},"$tiMBmtbOP6");if(t.value.message?y(t.value.message):t.value.error&&V(t.value.error),t.value.for_print){const e=window.open("","_blank");e==null||e.document.write(t.value.for_print),g(200).then(()=>{e==null||e.document.close(),e==null||e.focus(),e==null||e.print()})}};return(t,e)=>(_(),f(D,null,{default:a(()=>[l(O,null,{default:a(()=>e[1]||(e[1]=[h(" Сборка на почту ")])),_:1}),l(U,null,{default:a(()=>[l(z,{modelValue:r(s),"onUpdate:modelValue":e[0]||(e[0]=k=>N(s)?s.value=k:null),headers:b,items:r(d),"show-select":""},null,8,["modelValue","items"]),r(s).length>0?(_(),f(E,{key:0,color:"primary",onClick:C},{default:a(()=>[h(" Распечатать список на отправку ("+P(r(s).length)+") ",1)]),_:1})):$("",!0)]),_:1})]),_:1}))}});export{ee as default};

import{u as N}from"./B83tnpwP.js";import{Z as O,O as U,$ as E,P as K,a0 as j,a1 as q,a2 as H,a3 as G,a4 as M,a5 as Z,a6 as J,a7 as Q,a8 as X,R as Y,a9 as W,i as _,aa as ee,ab as ae,ac as te,ad as le,ae as se,af as oe,ag as ne,ah as re,ai as ie,aj as ce,ak as ue,z as l,al as de,am as me,an as x,K as B,ao as ve,d as fe,D as ye,C as ke,r as h,L as be,ap as Ce,F as d,A as r,q as ge,t as m,B as v,G as P,aq as _e,y as Pe,H as Ve}from"./CD-ciyMC.js";import{V as pe,a as Se,b as xe}from"./S1xGE2Sl.js";import"./D2qL_eWx.js";import"./tHn_lS1N.js";const he=window.setInterval,Te=O("v-alert-title"),Be=["success","info","warning","error"],Ie=U({border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:E,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>Be.includes(e)},...K(),...j(),...q(),...H(),...G(),...M(),...Z(),...J(),...Q(),...X({variant:"flat"})},"VAlert"),T=Y()({name:"VAlert",props:Ie(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,f){let{emit:y,slots:t}=f;const k=W(e,"modelValue"),o=_(()=>{if(e.icon!==!1)return e.type?e.icon??`$${e.type}`:e.icon}),c=_(()=>({color:e.color??e.type,variant:e.variant})),{themeClasses:u}=ee(e),{colorClasses:n,colorStyles:b,variantClasses:C}=ae(c),{densityClasses:s}=te(e),{dimensionStyles:a}=le(e),{elevationClasses:I}=se(e),{locationStyles:A}=oe(e),{positionClasses:$}=ne(e),{roundedClasses:w}=re(e),{textColorClasses:D,textColorStyles:L}=ie(ce(e,"borderColor")),{t:z}=ue(),V=_(()=>({"aria-label":z(e.closeLabel),onClick(g){k.value=!1,y("click:close",g)}}));return()=>{const g=!!(t.prepend||o.value),F=!!(t.title||e.title),R=!!(t.close||e.closable);return k.value&&l(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},u.value,n.value,s.value,I.value,$.value,w.value,C.value,e.class],style:[b.value,a.value,A.value,e.style],role:"alert"},{default:()=>{var p,S;return[de(!1,"v-alert"),e.border&&l("div",{key:"border",class:["v-alert__border",D.value],style:L.value},null),g&&l("div",{key:"prepend",class:"v-alert__prepend"},[t.prepend?l(x,{key:"prepend-defaults",disabled:!o.value,defaults:{VIcon:{density:e.density,icon:o.value,size:e.prominent?44:28}}},t.prepend):l(me,{key:"prepend-icon",density:e.density,icon:o.value,size:e.prominent?44:28},null)]),l("div",{class:"v-alert__content"},[F&&l(Te,{key:"title"},{default:()=>{var i;return[((i=t.title)==null?void 0:i.call(t))??e.title]}}),((p=t.text)==null?void 0:p.call(t))??e.text,(S=t.default)==null?void 0:S.call(t)]),t.append&&l("div",{key:"append",class:"v-alert__append"},[t.append()]),R&&l("div",{key:"close",class:"v-alert__close"},[t.close?l(x,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var i;return[(i=t.close)==null?void 0:i.call(t,{props:V.value})]}}):l(B,ve({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},V.value),null)])]}})}}}),ze=fe({__name:"print",setup(e){N({title:"Автопечать"});const{email:f,password:y}=ye(),{showError:t}=ke(),o=ge().public.backendUrl,c=h(!1);let u;const n=h([]);window.navigator.userAgent==="adminpage configuration"&&(c.value=!0,u=he(()=>{const{data:s,error:a}=be(`${o}/order_print_for_assembly.php`,{method:"POST",body:{staff_login:f,staff_password:y}},"$7aIB8dKoKu");s&&s.value&&s.value.html_print?n.value.push(s.value.html_print):a&&t("Ошибка соединения с сервером")},1e3)),Ce(()=>clearInterval(u));const b=s=>new Promise(a=>setTimeout(a,s)),C=()=>{const s=n.value.pop();if(s){const a=window.open("","_blank");a==null||a.document.write(s),b(200).then(()=>{a==null||a.document.close(),a==null||a.focus(),a==null||a.print()})}};return(s,a)=>(m(),d(pe,null,{default:r(()=>[l(Se,null,{default:r(()=>a[0]||(a[0]=[v(" Автопечать заказов на сборку ")])),_:1}),l(xe,null,{default:r(()=>[P(c)?(m(),d(T,{key:1,color:"success"},{default:r(()=>[a[2]||(a[2]=v(" Ожидание заказов для печати ")),l(_e,{color:"error",indeterminate:""})]),_:1})):(m(),d(T,{key:0,color:"error"},{default:r(()=>a[1]||(a[1]=[v(" Запустите Supermium с правильной настройкой для автопечати ")])),_:1})),P(n).length>0?(m(),d(B,{key:2,color:"primary",class:"mt-2",onClick:C},{default:r(()=>[v(" Печать ("+Pe(P(n).length)+") ",1)]),_:1})):Ve("",!0)]),_:1})]),_:1}))}});export{ze as default};

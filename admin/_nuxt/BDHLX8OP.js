import{u as se}from"./C0pAtJqh.js";import{M as de,N as ce,R as me,i as M,r as p,X as fe,Y as ve,o as Ve,D as R,e as pe,Z as ge,z as o,V as E,$ as G,I as C,a0 as xe,a1 as ye,a2 as W,a3 as we,a4 as be,a5 as Ce,d as ke,L as Pe,C as Fe,E as Ue,A as c,q as Se,t as Ie,B as j,F as a,H as Q,J as A}from"./B1_Hl8uH.js";import{k as z}from"./CfZuxCf1.js";import{u as Re}from"./DQpfZfJT.js";import{V as ee,a as he,b as te,c as Te}from"./C-rbV1EV.js";import{a as ze,V as Be}from"./BaPA-ebZ.js";import{a as Ne,b as $e,u as He,d as le,f as Me,e as Ae,g as Oe,V as i}from"./l_kyqZ6E.js";import{V as _e}from"./CJMpZFdM.js";import{I as De,u as qe,V as J}from"./BrzFJEKX.js";import{f as Ee}from"./DWGaNmQL.js";import{V as Ge}from"./BvXpFEPO.js";import{V as We}from"./D6i0_gJv.js";import"./Ct-uUTWm.js";/* empty css        */import"./Ca84myvZ.js";import"./Bw0Jv46Q.js";import"./CzA-VZ75.js";import"./hfnGxc_G.js";import"./BnsnIHaH.js";const je=de({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Ne(),...$e()},"VTextarea"),Je=ce()({name:"VTextarea",directives:{Intersect:De},inheritAttrs:!1,props:je(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,h){let{attrs:g,emit:b,slots:m}=h;const d=me(e,"modelValue"),{isFocused:k,focus:P,blur:O}=He(e),T=M(()=>typeof e.counterValue=="function"?e.counterValue(d.value):(d.value||"").toString().length),n=M(()=>{if(g.maxlength)return g.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function x(u,f){var s,V;!e.autofocus||!u||(V=(s=f[0].target)==null?void 0:s.focus)==null||V.call(s)}const v=p(),F=p(),B=fe(""),U=p(),r=M(()=>e.persistentPlaceholder||k.value||e.active);function t(){var u;U.value!==document.activeElement&&((u=U.value)==null||u.focus()),k.value||P()}function l(u){t(),b("click:control",u)}function L(u){b("mousedown:control",u)}function ae(u){u.stopPropagation(),t(),W(()=>{d.value="",we(e["onClick:clear"],u)})}function oe(u){var s;const f=u.target;if(d.value=f.value,(s=e.modelModifiers)!=null&&s.trim){const V=[f.selectionStart,f.selectionEnd];W(()=>{f.selectionStart=V[0],f.selectionEnd=V[1]})}}const S=p(),N=p(+e.rows),_=M(()=>["plain","underlined"].includes(e.variant));ve(()=>{e.autoGrow||(N.value=+e.rows)});function I(){e.autoGrow&&W(()=>{if(!S.value||!F.value)return;const u=getComputedStyle(S.value),f=getComputedStyle(F.value.$el),s=parseFloat(u.getPropertyValue("--v-field-padding-top"))+parseFloat(u.getPropertyValue("--v-input-padding-top"))+parseFloat(u.getPropertyValue("--v-field-padding-bottom")),V=S.value.scrollHeight,$=parseFloat(u.lineHeight),D=Math.max(parseFloat(e.rows)*$+s,parseFloat(f.getPropertyValue("--v-input-control-height"))),q=parseFloat(e.maxRows)*$+s||1/0,w=Ce(V??0,D,q);N.value=Math.floor((w-s)/$),B.value=be(w)})}Ve(I),R(d,I),R(()=>e.rows,I),R(()=>e.maxRows,I),R(()=>e.density,I);let y;return R(S,u=>{u?(y=new ResizeObserver(I),y.observe(S.value)):y==null||y.disconnect()}),pe(()=>{y==null||y.disconnect()}),qe(()=>{const u=!!(m.counter||e.counter||e.counterValue),f=!!(u||m.details),[s,V]=ge(g),{modelValue:$,...D}=le.filterProps(e),q=Me(e);return o(le,E({ref:v,modelValue:d.value,"onUpdate:modelValue":w=>d.value=w,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":_.value},e.class],style:e.style},s,D,{centerAffix:N.value===1&&!_.value,focused:k.value}),{...m,default:w=>{let{id:H,isDisabled:K,isDirty:X,isReadonly:ne,isValid:ue}=w;return o(Ae,E({ref:F,style:{"--v-textarea-control-height":B.value},onClick:l,onMousedown:L,"onClick:clear":ae,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},q,{id:H.value,active:r.value||X.value,centerAffix:N.value===1&&!_.value,dirty:X.value||e.dirty,disabled:K.value,focused:k.value,error:ue.value===!1}),{...m,default:ie=>{let{props:{class:Y,...Z}}=ie;return o(G,null,[e.prefix&&o("span",{class:"v-text-field__prefix"},[e.prefix]),C(o("textarea",E({ref:U,class:Y,value:d.value,onInput:oe,autofocus:e.autofocus,readonly:ne.value,disabled:K.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:t,onBlur:O},Z,V),null),[[xe("intersect"),{handler:x},null,{once:!0}]]),e.autoGrow&&C(o("textarea",{class:[Y,"v-textarea__sizer"],id:`${Z.id}-sizer`,"onUpdate:modelValue":re=>d.value=re,ref:S,readonly:!0,"aria-hidden":"true"},null),[[ye,d.value]]),e.suffix&&o("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:f?w=>{var H;return o(G,null,[(H=m.details)==null?void 0:H.call(m,w),u&&o(G,null,[o("span",null,null),o(Oe,{active:e.persistentCounter||k.value,value:T.value,max:n.value,disabled:e.disabled},m.counter)])])}:void 0})}),Ee({},v,F,U)}}),ft=ke({__name:"products",setup(e){const h=Pe({mask:"0.99",eager:!0,tokens:{0:{pattern:/\d/,multiple:!0},9:{pattern:/\d/,optional:!0}}});se({title:"Товары"});const{email:g,password:b}=Fe(),{showError:m,showSuccess:d}=Re(),P=Se().public.backendUrl,O=[{title:"Название",key:"name"},{title:"Артикул",key:"art"},{title:"",key:"actions"}],T=p([]),n=p(null),x=p(""),v=p(!1);R(x,async()=>{const{data:r}=await A(`${P}/search.php`,{method:"POST",body:{email:g,password:b},query:{search:x.value}},"$cOWNPPgU8q");T.value=r.value});const F=async r=>{const t=r.art.split("=")[1],{data:l}=await A(`${P}/good_details.php`,{method:"POST",body:{staff_login:g,staff_password:b,art:t}},"$qN6PabdkWd");l.value.good?(n.value=l.value.good,v.value=!0):l.value.error&&m(l.value.error)},B=async()=>{const{data:r}=await A(`${P}/good_update.php`,{method:"POST",body:{staff_login:g,staff_password:b,product:n.value}},"$Le0FIJ3WzT");r.value.message?(d(r.value.message),v.value=!1,await U()):r.value.error&&m(r.value.error)},U=async()=>{const{data:r}=await A(`${P}/search.php`,{method:"POST",body:{email:g,password:b},query:{search:x.value}},"$GcwM0HKSOj");T.value=r.value};return(r,t)=>(Ie(),Ue(ee,null,{default:c(()=>[o(he,null,{default:c(()=>t[17]||(t[17]=[j(" Товары ")])),_:1}),o(te,null,{default:c(()=>[o(ze,null,{default:c(()=>[o(Be,{cols:"12",md:"6"},{default:c(()=>[o(i,{modelValue:a(x),"onUpdate:modelValue":t[0]||(t[0]=l=>Q(x)?x.value=l:null),label:"Наименование, артикул"},null,8,["modelValue"])]),_:1})]),_:1}),o(_e,{headers:O,items:a(T)},{"item.actions":c(({item:l})=>[o(J,{color:"warning",icon:"mdi-pencil",density:"compact",onClick:L=>F(l)},null,8,["onClick"])]),_:2},1032,["items"])]),_:1}),o(We,{modelValue:a(v),"onUpdate:modelValue":t[16]||(t[16]=l=>Q(v)?v.value=l:null),"max-width":"600"},{default:c(()=>[o(ee,null,{default:c(()=>[o(te,null,{default:c(()=>[o(i,{modelValue:a(n).art,"onUpdate:modelValue":t[1]||(t[1]=l=>a(n).art=l),label:"Артикул",disabled:""},null,8,["modelValue"]),o(i,{modelValue:a(n).name,"onUpdate:modelValue":t[2]||(t[2]=l=>a(n).name=l),label:"Название",density:"compact"},null,8,["modelValue"]),o(i,{modelValue:a(n).description_short,"onUpdate:modelValue":t[3]||(t[3]=l=>a(n).description_short=l),label:"Короткое описание",density:"compact"},null,8,["modelValue"]),o(Je,{modelValue:a(n).description_full,"onUpdate:modelValue":t[4]||(t[4]=l=>a(n).description_full=l),label:"Полное описание",density:"compact"},null,8,["modelValue"]),C(o(i,{modelValue:a(n).price,"onUpdate:modelValue":t[5]||(t[5]=l=>a(n).price=l),label:"Цена",density:"compact"},null,8,["modelValue"]),[[a(z),a(h)]]),C(o(i,{modelValue:a(n).price_old,"onUpdate:modelValue":t[6]||(t[6]=l=>a(n).price_old=l),label:"Цена старая",density:"compact"},null,8,["modelValue"]),[[a(z),a(h)]]),C(o(i,{modelValue:a(n).qty,"onUpdate:modelValue":t[7]||(t[7]=l=>a(n).qty=l),label:"Количество",density:"compact"},null,8,["modelValue"]),[[a(z),"#############"]]),C(o(i,{modelValue:a(n).barcode,"onUpdate:modelValue":t[8]||(t[8]=l=>a(n).barcode=l),label:"Barcode",density:"compact"},null,8,["modelValue"]),[[a(z),"#############"]]),o(i,{modelValue:a(n).producer,"onUpdate:modelValue":t[9]||(t[9]=l=>a(n).producer=l),label:"Производитель",density:"compact"},null,8,["modelValue"]),o(i,{modelValue:a(n).producer_country,"onUpdate:modelValue":t[10]||(t[10]=l=>a(n).producer_country=l),label:"Страна",density:"compact"},null,8,["modelValue"]),o(i,{modelValue:a(n).cat,"onUpdate:modelValue":t[11]||(t[11]=l=>a(n).cat=l),label:"Категория",density:"compact"},null,8,["modelValue"]),o(i,{modelValue:a(n).subcat,"onUpdate:modelValue":t[12]||(t[12]=l=>a(n).subcat=l),label:"Подкатегория",density:"compact"},null,8,["modelValue"]),C(o(i,{modelValue:a(n).koef_ed_izm,"onUpdate:modelValue":t[13]||(t[13]=l=>a(n).koef_ed_izm=l),label:"Коэффициент ед. изм.",density:"compact"},null,8,["modelValue"]),[[a(z),a(h)]]),o(i,{modelValue:a(n).ed_izm_name,"onUpdate:modelValue":t[14]||(t[14]=l=>a(n).ed_izm_name=l),label:"Название ед. изм.",density:"compact"},null,8,["modelValue"])]),_:1}),o(Te,null,{default:c(()=>[o(Ge),o(J,{onClick:t[15]||(t[15]=l=>v.value=!1)},{default:c(()=>t[18]||(t[18]=[j(" Отмена ")])),_:1}),o(J,{onClick:B},{default:c(()=>t[19]||(t[19]=[j(" Сохранить ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{ft as default};
